(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"+sIk":function(t,e,r){"use strict";r.r(e);function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,a;return e=t,a=[{key:"all",value:function(t,e){var r={page:t};axios.get("/api/products",{params:r}).then((function(t){e(null,t.data)})).catch((function(t){e(t,t.response.data)}))}}],(r=null)&&n(e.prototype,r),a&&n(e,a),t}(),s=r("zonO"),o=r("lq+l"),i={name:"ProductList",data:function(){return{products:[],currentPriceEdit:null,meta:null,links:{first:null,last:null,next:null,prev:null},error:null}},beforeRouteEnter:function(t,e,r){a.all(t.query.page,(function(t,e){r((function(r){return r.setProducts(t,e)}))}))},beforeRouteUpdate:function(t,e,r){var n=this;this.products=this.links=this.meta=null,a.all(t.query.page,(function(t,e){n.setProducts(t,e),r()}))},methods:{setProducts:function(t,e){var r=e.data,n=e.links,a=e.meta;t?this.error=t.toString():(this.products=r,this.links=n,this.meta=a)},startEdit:function(t){this.currentPriceEdit=t.target.innerText},onEdit:function(t,e){e.target.blur();var r=isNaN(parseInt(e.target.innerText))?this.currentPriceEdit:parseInt(e.target.innerText);e.target.innerText=r.toString(),r.toString()!==this.currentPriceEdit&&this.onSubmit(t,r)},endEdit:function(t){this.$el.querySelector("#p"+t).blur()},onSubmit:function(t,e){var r=this;new o.a({price:e}).patch("/api/products/"+t).then((function(t){return r.$swal(t.message,"","success")}))}},components:{PagePaginate:s.a}},u=r("KHd+"),l=Object(u.a)(i,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container mx-auto py-6"},[r("h1",{staticClass:"mb-3 text-3xl"},[t._v("Список продутов")]),t._v(" "),r("page-paginate",{attrs:{links:t.links,meta:t.meta}}),t._v(" "),r("table",{staticClass:"shadow-lg w-full table-auto"},[t._m(0),t._v(" "),r("tbody",t._l(t.products,(function(e){return r("tr",[r("td",{staticClass:"border px-4 py-2",domProps:{textContent:t._s(e.id)}}),t._v(" "),r("td",{staticClass:"border px-4 py-2",domProps:{textContent:t._s(e.name)}}),t._v(" "),r("td",{staticClass:"border px-4 py-2",domProps:{textContent:t._s(e.vendor.name)}}),t._v(" "),r("td",{staticClass:"border px-4 py-2",attrs:{contenteditable:"",id:"p"+e.id},domProps:{textContent:t._s(e.price)},on:{focus:function(e){return t.startEdit(e)},blur:function(r){return t.onEdit(e.id,r)},keydown:function(r){return!r.type.indexOf("key")&&t._k(r.keyCode,"enter",13,r.key,"Enter")?null:t.endEdit(e.id)}}})])})),0)])],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",{staticClass:"bg-gray-200 border px-4 py-4 cursor-pointer"},[this._v("Id")]),this._v(" "),e("th",{staticClass:"bg-gray-200 border px-4 py-4 cursor-pointer"},[this._v("Наименование")]),this._v(" "),e("th",{staticClass:"bg-gray-200 border px-4 py-4 cursor-pointer"},[this._v("Поставщик")]),this._v(" "),e("th",{staticClass:"bg-gray-200 border px-4 py-4 cursor-pointer"},[this._v("Цена")])])])}],!1,null,null,null);e.default=l.exports},AN1W:function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,a;return e=t,a=[{key:"find",value:function(t,e){return axios.get("/api/orders/"+t).then((function(t){e(null,t.data)})).catch((function(t){e(t,t.response.data)}))}},{key:"all",value:function(t,e){var r={page:t};axios.get("/api/orders",{params:r}).then((function(t){e(null,t.data)})).catch((function(t){e(t,t.response.data)}))}}],(r=null)&&n(e.prototype,r),a&&n(e,a),t}();e.a=a},jO23:function(t,e,r){"use strict";r.r(e);var n=r("AN1W"),a=r("lq+l"),s={name:"OrderEdit",data:function(){return{order:null,form:new a.a({})}},beforeRouteEnter:function(t,e,r){t.params.order?r((function(e){return e.order=t.params.order})):n.a.find(t.params.id,(function(t,e){r((function(t){return t.order=e.data}))}))},computed:{costOrder:function(){return this.order.products.map((function(t){return t.price*t.quantity})).reduce((function(t,e){return t+e}),0)}},methods:{onSubmit:function(){var t=this;this.form=new a.a({client_email:this.order.client_email,partner_id:this.order.partner_id,status:this.order.status}),this.form.patch("/api/orders/"+this.order.id).then((function(e){return t.$swal(e.message,"","success")}))}}},o=r("KHd+"),i=Object(o.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.order?r("div",{staticClass:"container mx-auto py-6"},[r("h1",{staticClass:"mb-3 text-3xl",domProps:{textContent:t._s("Заказ № "+t.order.id)}}),t._v(" "),r("div",{staticClass:"max-w-3xl px-12 py-8 shadow-lg"},[r("h3",{staticClass:"mb-3 text-xl font-medium"},[t._v("Состав заказа")]),t._v(" "),r("table",{staticClass:"w-full mb-6"},[t._l(t.order.products,(function(e){return r("tr",[r("td",{staticClass:"border-t border-b px-4 py-2",domProps:{textContent:t._s(e.name)}}),t._v(" "),r("td",{staticClass:"border-t border-b px-4 py-2",domProps:{textContent:t._s(e.quantity+" шт.")}}),t._v(" "),r("td",{staticClass:"border-t border-b px-4 py-2",domProps:{textContent:t._s(e.price*e.quantity+" руб.")}})])})),t._v(" "),r("tr",[r("td",{staticClass:"px-4 py-2 text-right font-medium",attrs:{colspan:"2"}},[t._v("Итого, стоимость заказа:")]),t._v(" "),r("td",{staticClass:"px-4 py-2 font-medium",domProps:{textContent:t._s(t.costOrder+" руб.")}})])],2),t._v(" "),r("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit(e)}}},[r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block font-medium mb-2 text-gray-700",attrs:{for:"client_email"}},[t._v("\n                    Клиент\n                ")]),t._v(" "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.order.client_email,expression:"order.client_email"}],staticClass:"appearance-none border focus:border-gray-400 focus:outline-none leading-tight px-3 py-2 rounded shadow text-gray-700 w-full",attrs:{id:"client_email",type:"email",required:""},domProps:{value:t.order.client_email},on:{input:function(e){e.target.composing||t.$set(t.order,"client_email",e.target.value)}}}),t._v(" "),t.form.errors.has("client_email")?r("span",{staticClass:"text-red-500 text-xs",domProps:{textContent:t._s(t.form.errors.get("client_email"))}}):t._e()]),t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block font-medium mb-2 text-gray-700",attrs:{for:"partner"}},[t._v("\n                    Партнер\n                ")]),t._v(" "),r("div",{staticClass:"relative"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.order.partner_id,expression:"order.partner_id"}],staticClass:"appearance-none border focus:border-gray-400 focus:outline-none leading-tight px-3 py-2 rounded shadow text-gray-700 w-full",attrs:{id:"partner",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.order,"partner_id",e.target.multiple?r:r[0])}}},t._l(t.$root.partners,(function(e){return r("option",{domProps:{value:e.id}},[t._v(t._s(e.name))])})),0),t._v(" "),r("div",{staticClass:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[r("svg",{staticClass:"fill-current h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[r("path",{attrs:{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"}})])])]),t._v(" "),t.form.errors.has("partner_id")?r("span",{staticClass:"text-red-500 text-xs",domProps:{textContent:t._s(t.form.errors.get("partner_id"))}}):t._e()]),t._v(" "),r("div",{staticClass:"mb-4"},[r("label",{staticClass:"block font-medium mb-2 text-gray-700",attrs:{for:"status"}},[t._v("\n                    Статус заказа\n                ")]),t._v(" "),r("div",{staticClass:"relative"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.order.status,expression:"order.status"}],staticClass:"appearance-none border focus:border-gray-400 focus:outline-none leading-tight px-3 py-2 rounded shadow text-gray-700 w-full",attrs:{id:"status",required:""},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.order,"status",e.target.multiple?r:r[0])}}},t._l(t.$root.statuses,(function(e,n){return r("option",{domProps:{value:n}},[t._v(t._s(e))])})),0),t._v(" "),r("div",{staticClass:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"},[r("svg",{staticClass:"fill-current h-4 w-4",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"}},[r("path",{attrs:{d:"M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"}})])])]),t._v(" "),t.form.errors.has("status")?r("span",{staticClass:"text-red-500 text-xs",domProps:{textContent:t._s(t.form.errors.get("status"))}}):t._e()]),t._v(" "),t._m(0)])])]):t._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flex justify-end"},[e("button",{staticClass:"bg-transparent hover:bg-green-500 text-green-700 font-semibold hover:text-white py-2 px-4 border border-green-500 hover:border-transparent rounded"},[this._v("\n                    Сохранить\n                ")])])}],!1,null,null,null);e.default=i.exports},"lq+l":function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errors={}}var e,r,a;return e=t,(r=[{key:"has",value:function(t){return this.errors.hasOwnProperty(t)}},{key:"any",value:function(){return Object.keys(this.errors).length>0}},{key:"get",value:function(t){if(this.errors[t])return this.errors[t][0]}},{key:"record",value:function(t){this.errors=t}},{key:"clear",value:function(t){t?delete this.errors[t]:this.errors={}}}])&&n(e.prototype,r),a&&n(e,a),t}();function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(e){for(var r in function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.originalData=e,e)this[r]=e[r];this.errors=new a}var e,r,n;return e=t,(r=[{key:"data",value:function(){var t={};for(var e in this.originalData)t[e]=this[e];return t}},{key:"reset",value:function(){for(var t in this.originalData)this[t]="";this.errors.clear()}},{key:"post",value:function(t){return this.submit("post",t)}},{key:"put",value:function(t){return this.submit("put",t)}},{key:"patch",value:function(t){return this.submit("patch",t)}},{key:"delete",value:function(t){return this.submit("delete",t)}},{key:"submit",value:function(t,e){var r=this;return new Promise((function(n,a){axios[t](e,r.data()).then((function(t){r.onSuccess(t.data),n(t.data)})).catch((function(t){r.onFail(t.response.data.errors),a(t.response.data.errors)}))}))}},{key:"onSuccess",value:function(t){this.reset()}},{key:"onFail",value:function(t){this.errors.record(t)}}])&&s(e.prototype,r),n&&s(e,n),t}();e.a=o},zonO:function(t,e,r){"use strict";var n={name:"PagePaginate",props:{links:Object,meta:Object},computed:{nextPage:function(){if(this.meta&&this.meta.current_page!==this.meta.last_page)return this.meta.current_page+1},prevPage:function(){if(this.meta&&1!==this.meta.current_page)return this.meta.current_page-1},paginationCount:function(){if(this.meta){var t=this.meta,e=t.current_page,r=t.last_page;return"".concat(e," of ").concat(r)}}}},a=r("KHd+"),s=Object(a.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mb-3 flex justify-between items-center"},[r("div",[r("router-link",{staticClass:"bg-white hover:bg-gray-100 text-gray-800 font-semibold py-2 px-4 border border-gray-400 rounded shadow",class:t.prevPage?"":"opacity-50 cursor-not-allowed",attrs:{tag:"button",to:{query:{page:t.prevPage}},disabled:!t.prevPage}},[t._v("Previous\n        ")]),t._v(" "),r("router-link",{staticClass:"bg-white hover:bg-gray-100 text-gray-800 font-semibold py-2 px-4 border border-gray-400 rounded shadow",class:t.nextPage?"":"opacity-50 cursor-not-allowed",attrs:{tag:"button",to:{query:{page:t.nextPage}},disabled:!t.nextPage}},[t._v("Next\n        ")])],1),t._v(" "),r("div",{staticClass:"font-bold",domProps:{textContent:t._s(t.paginationCount)}})])}),[],!1,null,null,null);e.a=s.exports}}]);